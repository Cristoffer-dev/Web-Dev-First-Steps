<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/x-icon" href="data:" />
    <title>New Message</title>
</head>
<body>
    <h1>New Message</h1>

    <span>To: </span> <input type="text" id="txtTo" />
    <br />
    <span>Message: </span> <input type="text" id="txtMessageBody" />
    <br />
    <span>Priority: </span>
    <select id="selPriority">
        <option value="0">Low</option>
        <option value="1" selected>Normal</option>
        <option value="2">High</option>
    </select>
    <br />
    <input type="button" value="Create new Message" onclick="returnMessageObject()" />

    <script>
        function returnMessageObject() {
            let message = new Object();
            message.to = document.getElementById("txtTo").value;
            message.messageBody = document.getElementById("txtMessageBody").value;
            let sel = document.getElementById("selPriority");
            message.priorityValue = sel.value;
            message.priorityText = sel.options[sel.selectedIndex].text;
            window.opener.receiveMessageData(message);
            window.close();
        }
    </script>
</body>
</html>
        